<div class="container" *ngIf="canManage; else noAccess">

  <mat-card class="rp-card">

    <mat-card-header>
      <mat-card-title>Gestione Permessi Ruolo</mat-card-title>
    </mat-card-header>

    <mat-card-content>

      <!-- Select Ruolo -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Ruolo</mat-label>
        <mat-select [(value)]="selectedRoleId" (selectionChange)="onRoleChange()">
          <mat-option *ngFor="let r of roles" [value]="r.id">
            {{ r.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <!-- Permessi -->
      <div *ngIf="selectedRoleId">

        <h3 class="perm-title">Permessi</h3>

        <div *ngFor="let p of permissions" class="perm-item">
          <mat-checkbox
            color="primary"
            [checked]="checked.has(p.id)"
            (change)="togglePermission(p, $event)"
          >
            {{ p.name }}
            <small *ngIf="p.description">â€“ {{ p.description }}</small>
          </mat-checkbox>
        </div>

        <button
          mat-raised-button
          color="primary"
          class="full-width mt-3"
          (click)="save()"
        >
          Salva
        </button>

      </div>

    </mat-card-content>

  </mat-card>

</div>

<!-- NO PERMISSION VIEW -->
<ng-template #noAccess>
  <div class="no-access">
    <mat-icon>block</mat-icon>
    <p>Non hai i permessi per accedere a questa sezione.</p>
  </div>
</ng-template>
