<h2 mat-dialog-title>Programma consegna</h2>

<mat-dialog-content>

  <form [formGroup]="form" class="step-form-row">

    <mat-form-field appearance="outline">
      <mat-label>Data</mat-label>
      <input matInput [matDatepicker]="picker" formControlName="dataConsegna">
      <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker></mat-datepicker>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Fascia</mat-label>
      <mat-select formControlName="oraConsegna">
        <mat-option value="M">Mattina</mat-option>
        <mat-option value="P">Pomeriggio</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Veicolo</mat-label>
      <mat-select formControlName="veicolo">
        <mat-option *ngFor="let v of veicoli" [value]="v.id">
          {{v.descrizione}}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <button
      mat-raised-button
      color="primary"
      [disabled]="form.invalid"
      (click)="caricaConsegne()">
      Mostra consegne
    </button>

  </form>

  <div
    cdkDropList
    class="consegne-list"
    (cdkDropListDropped)="drop($event)"
    *ngIf="consegne.length">

    <div
      class="consegna-card"
      *ngFor="let c of consegne"
      cdkDrag>

      <div class="consegna-header">
        <div class="ordine-index">{{c.ordine}}</div>
        <div class="localita">{{c.localita}}</div>
        <div class="header-right">
          {{c.anno}}/{{c.serie}}/{{c.progressivo}}
        </div>
      </div>

      <div class="consegna-body">
        <b>{{c.intestazione}}</b>
        <div>{{c.riferimento}}</div>
      </div>

      <div class="consegna-footer">
        <span class="badge">{{c.oraConsegna === 'P' ? 'Pomeriggio' : 'Mattina'}}</span>
        <span class="badge">{{c.descVeicolo}}</span>
      </div>

    </div>
  </div>

</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="chiudi()">Annulla</button>
  <button mat-raised-button color="primary" (click)="conferma()">
    Conferma
  </button>
</mat-dialog-actions>
